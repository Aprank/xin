{"version":3,"sources":["webpack:///./components/repeat.js"],"names":["xin","require","T","FILTER_ALL","Repeat","prototype","__templateInitialize","call","items","rows","length","forEach","row","__children","node","parentElement","removeChild","filter","item","index","__templateModel","set","as","indexAs","render","push","err","console","error","stack","element","__model","__item","__index","_itemsChanged","type","Array","observer","String","value","Object","base","define","extends","module","exports"],"mappings":";;;;;;;;;;;;;;AAAA,KAAMA,MAAM,mBAAAC,CAAQ,CAAR,CAAZ;AACA,KAAMC,IAAI,mBAAAD,CAAQ,CAAR,CAAV;;AAEA,KAAME,aAAa,SAAbA,UAAa;AAAA,UAAM,IAAN;AAAA,EAAnB;;KAEMC,M;;;;;;;;;;;sCAyBc;AAChBF,SAAEG,SAAF,CAAYC,oBAAZ,CAAiCC,IAAjC,CAAsC,IAAtC,EAA4C,IAA5C,EAAkD,IAAlD;AACD;;;mCAEcC,K,EAAO;AAAA;;AACpB,WAAI,KAAKC,IAAL,IAAa,KAAKA,IAAL,CAAUC,MAA3B,EAAmC;AACjC,cAAKD,IAAL,CAAUE,OAAV,CAAkB,UAAUC,GAAV,EAAe;AAC/BA,eAAIC,UAAJ,CAAeF,OAAf,CAAuB,UAAUG,IAAV,EAAgB;AACrCA,kBAAKC,aAAL,CAAmBC,WAAnB,CAA+BF,IAA/B;AACD,YAFD;AAGD,UAJD;AAKD;;AAED,WAAI,CAACN,KAAL,EAAY;AACV;AACD;;AAED,YAAKC,IAAL,GAAY,EAAZ;AACAD,aAAMS,MAAN,CAAa,KAAKA,MAAL,IAAed,UAA5B,EAAwCQ,OAAxC,CAAgD,UAACO,IAAD,EAAOC,KAAP,EAAiB;AAC/D,aAAI;AACF,eAAIP,MAAM,IAAIV,CAAJ,SAAY,OAAKkB,eAAjB,SAAV;AACAR,eAAIS,GAAJ,CAAQ,OAAKC,EAAb,EAAiBJ,IAAjB;AACAN,eAAIS,GAAJ,CAAQ,OAAKE,OAAb,EAAsBJ,KAAtB;;AAEAP,eAAIY,MAAJ;AACA,kBAAKf,IAAL,CAAUgB,IAAV,CAAeb,GAAf;AACD,UAPD,CAOE,OAAOc,GAAP,EAAY;AACZC,mBAAQC,KAAR,CAAcF,IAAIG,KAAlB;AACD;AACF,QAXD;AAYD;;;oCAEeC,O,EAAS;AACvB,cAAOA,WAAW,CAACA,QAAQC,OAA3B,EAAoC;AAClCD,mBAAUA,QAAQf,aAAlB;AACD;AACD,cAAOe,QAAQE,MAAf;AACD;;;qCAEgBF,O,EAAS;AACxB,cAAOA,WAAW,CAACA,QAAQC,OAA3B,EAAoC;AAClCD,mBAAUA,QAAQf,aAAlB;AACD;AACD,cAAOe,QAAQG,OAAf;AACD;;;qCAEgBH,O,EAAS;AACxB,cAAOA,WAAW,CAACA,QAAQC,OAA3B,EAAoC;AAClCD,mBAAUA,QAAQf,aAAlB;AACD;AACD,cAAOe,QAAQC,OAAf;AACD;;;oCAEed,M,EAAQ;AACtB,WAAI,OAAOA,MAAP,KAAkB,UAAtB,EAAkC;AAChC;AACD;;AAED,YAAKiB,aAAL,CAAmB,KAAK1B,KAAxB;AACD;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;yBAnLa;AACX,cAAO;AACLA,gBAAO;AACL2B,iBAAMC,KADD;AAELC,qBAAU;AAFL,UADF;;AAMLf,aAAI;AACFa,iBAAMG,MADJ;AAEFC,kBAAO;AAFL,UANC;;AAWLhB,kBAAS;AACPY,iBAAMG,MADC;AAEPC,kBAAO;AAFA,UAXJ;;AAgBLtB,iBAAQ;AACNkB,iBAAMK,MADA;AAENH,qBAAU;AAFJ;AAhBH,QAAP;AAqBD;;;;GAvBkBrC,IAAIyC,IAAJ,CAAS,qBAAT,C;;AAuLrBzC,KAAI0C,MAAJ,CAAW,YAAX,EAAyBtC,MAAzB,EAAiC,EAAEuC,SAAS,UAAX,EAAjC;AACA3C,KAAII,MAAJ,GAAaA,MAAb;;AAEAwC,QAAOC,OAAP,GAAiBzC,MAAjB,C","file":"components/repeat.js","sourcesContent":["const xin = require('../');\nconst T = require('template-binding');\n\nconst FILTER_ALL = () => true;\n\nclass Repeat extends xin.base('HTMLTemplateElement') {\n  get props () {\n    return {\n      items: {\n        type: Array,\n        observer: '_itemsChanged',\n      },\n\n      as: {\n        type: String,\n        value: 'item',\n      },\n\n      indexAs: {\n        type: String,\n        value: 'index',\n      },\n\n      filter: {\n        type: Object,\n        observer: '_filterChanged',\n      },\n    };\n  }\n\n  __initTemplate () {\n    T.prototype.__templateInitialize.call(this, null, this);\n  }\n\n  _itemsChanged (items) {\n    if (this.rows && this.rows.length) {\n      this.rows.forEach(function (row) {\n        row.__children.forEach(function (node) {\n          node.parentElement.removeChild(node);\n        });\n      });\n    }\n\n    if (!items) {\n      return;\n    }\n\n    this.rows = [];\n    items.filter(this.filter || FILTER_ALL).forEach((item, index) => {\n      try {\n        let row = new T(this, this.__templateModel, this);\n        row.set(this.as, item);\n        row.set(this.indexAs, index);\n\n        row.render();\n        this.rows.push(row);\n      } catch (err) {\n        console.error(err.stack);\n      }\n    });\n  }\n\n  itemForElement (element) {\n    while (element && !element.__model) {\n      element = element.parentElement;\n    }\n    return element.__item;\n  }\n\n  indexForElement (element) {\n    while (element && !element.__model) {\n      element = element.parentElement;\n    }\n    return element.__index;\n  }\n\n  modelForElement (element) {\n    while (element && !element.__model) {\n      element = element.parentElement;\n    }\n    return element.__model;\n  }\n\n  _filterChanged (filter) {\n    if (typeof filter !== 'function') {\n      return;\n    }\n\n    this._itemsChanged(this.items);\n  }\n\n  // created () {\n  //   console.log('created', this);\n  //   // this.rowProto = {}; //xin.Component;\n  //   // xin.base({\n  //   //   is: '$xin-repeat-row',\n  //   // });\n  //\n  //   // var templateHost = this;\n  //   // var __set = this.rowProto.set;\n  //   // this.rowProto.set = function (name, value) {\n  //   //   var nameSegments = name.split('.');\n  //   //   switch (nameSegments[0]) {\n  //   //     case templateHost.as:\n  //   //     case templateHost.indexAs:\n  //   //       return __set.apply(this, arguments);\n  //   //     default:\n  //   //       // var oldValue = this.__host.get(name);\n  //   //       return this.__host.set(name, value);\n  //   //   }\n  //   // };\n  //   //\n  //   // var __get = this.rowProto.get;\n  //   // this.rowProto.get = function (name) {\n  //   //   var nameSegments = name.split('.');\n  //   //   switch (nameSegments[0]) {\n  //   //     case templateHost.as:\n  //   //     case templateHost.indexAs:\n  //   //       return __get.apply(this, arguments);\n  //   //     default:\n  //   //       return this.__host.get(name);\n  //   //   }\n  //   // };\n  //\n  //   // if (!this.content && HTMLTemplateElement.decorate) {\n  //   //   HTMLTemplateElement.decorate(this);\n  //   // }\n  //\n  //   // Row is class to create new row\n  //   // var self = this;\n  //   // this.Row = function (item, index) {\n  //   //   var row = this;\n  //   //   var fragment = this.fragment = document.importNode(self.content, true);\n  //   //   this.__root = xin.dom(fragment).childNodes.map(function (node) {\n  //   //     node.__model = row;\n  //   //     node.__index = index;\n  //   //     node.__item = item;\n  //   //     return node;\n  //   //   });\n  //   //\n  //   //   this.__initialize();\n  //   //\n  //   //   this.__host = self.__parent;\n  //   //\n  //   //   this.__parseAnnotations();\n  //   //\n  //   //   this.set(self.as, item);\n  //   //\n  //   //   // if (self.parentElement) {\n  //   //   //  xin.dom(self.parentElement).insertBefore(fragment, self);\n  //   //   // }\n  //   // };\n  //   // this.Row.prototype = this.rowProto;\n  // }\n\n  // __insertRow (item, index) {\n  //   console.log(item, index);\n  //   // var fragment = document.importNode(this.content, true);\n  //   // var row = {\n  //   //  __root: xin.dom(fragment).childNodes\n  //   // };\n  //\n  //   // row.__root.forEach(function(node) {\n  //   //  node.__model = row;\n  //   //  node.__index = index;\n  //   //  node.__item = item;\n  //   // });\n  //\n  //   // Object.setPrototypeOf(row, this.rowProto);\n  //\n  //   // row.__initialize();\n  //\n  //   // row.__host = this.__parent;\n  //\n  //   // row.__parseAnnotations();\n  //\n  //   // row.set(this.as, item);\n  //\n  //   // if (this.parentElement) {\n  //   //  xin.dom(this.parentElement).insertBefore(fragment, this);\n  //   // }\n  //\n  //   var row = new this.Row(item, index);\n  //\n  //   return row;\n  // }\n}\n\nxin.define('xin-repeat', Repeat, { extends: 'template' });\nxin.Repeat = Repeat;\n\nmodule.exports = Repeat;\n\n\n\n/** WEBPACK FOOTER **\n ** ./components/repeat.js\n **/"],"sourceRoot":""}
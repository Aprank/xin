webpackJsonp([0],[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}return o.done?void e(u):Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=this,r=!0,n=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if("function"!=typeof s)throw new TypeError("Middleware must be composed of functions!")}}catch(e){n=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw i}}return function(){var r=a(regeneratorRuntime.mark(function r(n,i){var o,u=function(){var t=a(regeneratorRuntime.mark(function t(r){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r<=o)){t.next=2;break}throw new Error("next() called multiple times");case 2:if(o=r,a=e[r],r===e.length&&(a=i),a){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,a(n,function(){return u(r+1)});case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}();return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=-1,e.abrupt("return",u(0));case 2:case"end":return e.stop()}},r,t)}));return function(e,t){return r.apply(this,arguments)}}()}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),h=r(1),l=n(h),f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"handleRouteNotFound",value:function(e){console.error("Route not found: "+e.detail)}},{key:"_titleChanged",value:function(e){document.title=e}},{key:"created",value:function(){l.default.put("app",this),this.__appSignature=!0,this.location=window.location,this.history=window.history,this.handlers=[],this.middlewares=[],this.__started=!1}},{key:"_hashSeparatorChanged",value:function(e){this.reHashSeparator=new RegExp(e+"(.*)$")}},{key:"attached",value:function(){this.manual||this.async(this.start)}},{key:"__isStatic",value:function(e){return!e.match(/[[{]/)}},{key:"__routeRegExp",value:function(e){var t=e.split("[");if(t.length>2)throw new Error("Invalid use of optional params");var r=[],n=t[0].replace(/{([^}]+)}/g,function(e,t){return r.push(t),"([^/]+)"}).replace(/\//g,"\\/"),a="";return t[1]&&(a="(?:"+t[1].slice(0,-1).replace(/{([^}]+)}/g,function(e,t){return r.push(t),"([^/]+)"}).replace(/\//g,"\\/")+")?"),[new RegExp("^"+n+a+"$"),r]}},{key:"route",value:function(e,t){var r={route:e,type:"s",pattern:null,args:[],callback:t};if(!this.__isStatic(e)){var n=this.__routeRegExp(e);r.type="v",r.pattern=n[0],r.args=n[1]}this.handlers.push(r)}},{key:"start",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.__started){e.next=2;break}return e.abrupt("return");case 2:return this.__middlewareChainRun=s(this.middlewares),e.next=5,this.__execute();case 5:t=e.sent,t&&(console.info("Started "+this.is+":"+this.__id),this.__started=!0,this.__listenNavigation(),this.fire("started"));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"__listenNavigation",value:function(){var e=this,t=this.__executeCallback=function(){e.__execute()};"history"===this.mode?(l.default.event(window).on("popstate",t),l.default.event(document).on("click",function(r){if(!r.defaultPrevented&&"A"===r.target.nodeName&&""===r.target.target){r.preventDefault();var n={url:r.target.getAttribute("href")};e.history.pushState(n,r.target.innerHTML,r.target.href),t()}})):l.default.event(window).on("hashchange",t)}},{key:"getFragmentExecutors",value:function(e){return e=e||this.getFragment(),this.handlers.reduce(function(t,r){return"s"===r.type?e===r.route&&t.push({handler:r,args:{}}):"v"===r.type&&!function(){var n=e.match(r.pattern);n&&!function(){var e={};r.args.forEach(function(t,r){e[t]=n[r+1]}),t.push({handler:r,args:e})}()}(),t},[])}},{key:"__execute",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getFragment(),r=this.getFragmentExecutors(t),0!==r.length){e.next=5;break}return this.fire("route-not-found",t),e.abrupt("return",!1);case 5:return n={uri:t},this.fire("navigated",n),e.next=9,this.__middlewareChainRun(n,function(){r.forEach(function(e){return e.handler.callback(e.args,n)})});case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"navigate",value:function(e,t){if(e=e||"/",t=t||{},"history"===this.mode){var r=this.rootUri+e.toString().replace(/\/$/,"").replace(/^\//,"");this.location.href.replace(this.location.origin,"")!==r&&(this.history[t.replace?"replaceState":"pushState"]({},document.title,r),this.__execute())}else this.location.href.match(this.reHashSeparator),this.location.href=this.location.href.replace(this.reHashSeparator,"")+this.hashSeparator+e;return this}},{key:"use",value:function(e){this.middlewares.push(e)}},{key:"getFragment",value:function(){var e=void 0;if("history"===this.mode)e=decodeURI(this.location.pathname+this.location.search),e=e.replace(/\?(.*)$/,""),e="/"===this.rootUri?e:e.replace(this.rootUri,"");else{var t=this.location.href.match(this.reHashSeparator);e=t?t[1]:""}return"/"+e.toString().replace(/\/$/,"").replace(/^\//,"")}},{key:"props",get:function(){return{docTitle:{type:String,value:"Application",observer:"_titleChanged"},manual:{type:Boolean},mode:{type:String,value:"hash"},rootUri:{type:String,value:"/"},hashSeparator:{type:String,value:"#!",observer:"_hashSeparatorChanged"}}}},{key:"listeners",get:function(){return{"route-not-found":"handleRouteNotFound(evt)"}}},{key:"started",get:function(){return this.__started||!1}}]),t}(l.default.Component);l.default.define("xin-app",f),l.default.App=f,t.default=f}]);
//# sourceMappingURL=app.min.js.map
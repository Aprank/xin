webpackJsonp([2],{16:function(t,e,n){"use strict";class i{static routeRegExp(t){let e=t.split("[");if(e.length>2)throw new Error("Invalid use of optional params");let n=[],i=e[0].replace(/{([^}]+)}/g,function(t,e){return n.push(e),"([^/]+)"}).replace(/\//g,"\\/"),r="";return e[1]&&(r="(?:"+e[1].slice(0,-1).replace(/{([^}]+)}/g,function(t,e){return n.push(e),"([^/]+)"}).replace(/\//g,"\\/")+")?"),[new RegExp("^"+i+r+"$"),n]}static isStatic(t){return!t.match(/[[{]/)}constructor(t,e){if(this.route=t,this.callback=e,i.isStatic(t))this.type="s",this.pattern=null,this.args=[];else{let e=i.routeRegExp(t);this.type="v",this.pattern=e[0],this.args=e[1]}}getExecutorFor(t){if("s"===this.type){if(t===this.route)return{handler:this,args:{}}}else if("v"===this.type){let e=t.match(this.pattern);if(e)return{handler:this,args:this.args.reduce((t,n,i)=>{return t[n]=e[i+1],t},{})}}}}e.a=i},17:function(t,e,n){"use strict";var i=n(2);n.d(e,"a",function(){return i.a})},37:function(t,e,n){"use strict";function i(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function i(r,o){try{var a=e[r](o),s=a.value}catch(t){return void n(t)}return a.done?void t(s):Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)})}return i("next")})}}function r(t){for(let e of t)if("function"!=typeof e)throw new TypeError("Middleware must be composed of functions!");return(()=>{var e=i(function*(e,n){let r=(()=>{var a=i(function*(i){if(i<=o)throw new Error("next() called multiple times");o=i;let a=t[i];if(i===t.length&&(a=n),a)return yield a(e,function(){return r(i+1)})});return function(t){return a.apply(this,arguments)}})(),o=-1;return r(0)});return function(t,n){return e.apply(this,arguments)}})()}var o=n(0),a=n(17),s=n(16);class h extends o.default.Component{get props(){return{docTitle:{type:String,value:"Application",observer:"_titleChanged"},manual:{type:Boolean},mode:{type:String,value:"hash"},rootUri:{type:String,value:"/"},hash:{type:String,value:"#!"}}}get hashRegexp(){return this._hashRegexp&&this._hash===this.hash||(this._hashRegexp=new RegExp(`${this.hash}(.*)$`),this._hash=this.hash),this._hashRegexp}notFound(t){console.warn(`Route not found: ${t}`)}_titleChanged(t){document.title=t}created(){o.default.put("app",this),this.__appSignature=!0,this.location=window.location,this.history=window.history,this.handlers=[],this.middlewares=[],this.__started=!1,this.__starting=!1}attached(){this.manual||this.async(()=>{this.start()})}route(t,e){this.handlers.push(new s.a(t,e))}start(){var t=this;return i(function*(){if(!t.__started&&!t.__starting){t.__middlewareChainRun=r(t.middlewares),t.__listenNavigation(),console.info(`Starting ${t.is}:${t.__id} ...`),t.__starting=!0;let e=yield t.__execute();t.__starting=!1,e&&(console.info(`Started ${t.is}:${t.__id}`),t.__started=!0,t.fire("started"))}})()}__listenNavigation(){let t=()=>{this.__execute()};"history"===this.mode?(n.i(a.a)(window).on("popstate",t),n.i(a.a)(document).on("click",e=>{if(!e.defaultPrevented&&"A"===e.target.nodeName&&""===e.target.target){e.preventDefault();let n={url:e.target.getAttribute("href")};this.history.pushState(n,e.target.innerHTML,e.target.href),t()}})):n.i(a.a)(window).on("hashchange",t)}get started(){return this.__started||!1}getFragmentExecutors(t){return this.handlers.reduce((e,n)=>{let i=n.getExecutorFor(t);return i&&e.push(i),e},[])}__execute(){var t=this;return i(function*(){let e=t.getFragment(),n={app:t,uri:e},i=yield t.__middlewareChainRun(n,function(){let i=t.getFragmentExecutors(n.uri);return 0===i.length?(t.notFound(e),void t.fire("route-not-found",e)):void i.forEach(function(t){t.handler.callback(t.args,n)})});return i!==!1&&(t.fire("navigated",n),!0)})()}navigate(t,e){if(t=t||"/",e=e||{},"history"===this.mode){let n=this.rootUri+t.toString().replace(/\/$/,"").replace(/^\//,"");this.location.href.replace(this.location.origin,"")!==n&&(this.history[e.replace?"replaceState":"pushState"]({},document.title,n),this.__execute())}else this.location.hash=this.hash+t;return this}use(t){this.middlewares.push(t)}getFragment(){try{let t;if("history"===this.mode)t=decodeURI(this.location.pathname+this.location.search),t=t.replace(/\?(.*)$/,""),t="/"===this.rootUri?t:t.replace(this.rootUri,"");else{let e=this.location.href.match(this.hashRegexp);t=e?e[1]:""}return"/"+t.toString().replace(/\/$/,"").replace(/^\//,"")}catch(t){return console.error("Fragment is not match any pattern, fallback to /"),"/"}}}o.default.define("xin-app",h),e.default=h}},[37]);
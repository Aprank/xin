{"version":3,"sources":["webpack:///components/app.min.js","webpack:///./components/app.js"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_asyncToGenerator","fn","gen","apply","this","arguments","Promise","resolve","reject","step","key","arg","info","value","error","done","then","err","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","compose","middlewares","_this5","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","return","_ref3","regeneratorRuntime","mark","_callee4","context","index","dispatch","_ref4","_callee3","i","wrap","_context3","prev","Error","length","abrupt","sent","stop","_x3","_context4","_x","_x2","defineProperty","_createClass","defineProperties","target","props","descriptor","protoProps","staticProps","_src","_src2","NOOP","App","_xin$Component","getPrototypeOf","evt","console","detail","title","document","put","__appSignature","location","window","history","handlers","__awaitRouteCallback","__started","__starting","_this2","manual","async","__availableUris","map","querySelectorAll","el","uri","start","pattern","match","str","chunks","split","tokens","re","replace","g","token","push","optRe","slice","RegExp","route","callback","routeHandler","type","args","__isStatic","result","__routeRegExp","getFragmentExecutors","getFragment","_ref","_callee","executed","_context","__middlewareChainRun","is","__id","__execute","__listenNavigation","fire","_this3","mode","event","on","defaultPrevented","nodeName","preventDefault","state","url","getAttribute","pushState","innerHTML","href","fragment","reduce","executors","handler","forEach","name","_this4","_ref2","_callee2","_context2","indexOf","__waitForRoute","executor","path","options","rootUri","toString","origin","hashSeparator","middleware","decodeURI","pathname","search","get","docTitle","String","observer","Boolean","route-not-found","Component","define"],"mappings":"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","file":"components/app.min.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _src = __webpack_require__(1);\n\t\n\tvar _src2 = _interopRequireDefault(_src);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NOOP = function NOOP() {};\n\t\n\tvar App = function (_xin$Component) {\n\t  _inherits(App, _xin$Component);\n\t\n\t  function App() {\n\t    _classCallCheck(this, App);\n\t\n\t    return _possibleConstructorReturn(this, (App.__proto__ || Object.getPrototypeOf(App)).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(App, [{\n\t    key: 'handleRouteNotFound',\n\t    value: function handleRouteNotFound(evt) {\n\t      console.error('Route not found: ' + evt.detail);\n\t    }\n\t  }, {\n\t    key: '_titleChanged',\n\t    value: function _titleChanged(title) {\n\t      document.title = title;\n\t    }\n\t  }, {\n\t    key: 'created',\n\t    value: function created() {\n\t      _src2.default.put('app', this);\n\t\n\t      // this.classList.add('xin-app');\n\t\n\t      this.__appSignature = true;\n\t      this.location = window.location;\n\t      this.history = window.history;\n\t\n\t      // default values\n\t      this.handlers = [];\n\t      this.middlewares = [];\n\t\n\t      this.__awaitRouteCallback = NOOP;\n\t      this.__started = false;\n\t      this.__starting = false;\n\t    }\n\t  }, {\n\t    key: 'attached',\n\t    value: function attached() {\n\t      var _this2 = this;\n\t\n\t      if (!this.manual) {\n\t        this.async(function () {\n\t          _this2.__availableUris = [].map.call(_this2.querySelectorAll('.xin-view'), function (el) {\n\t            return el.uri;\n\t          });\n\t          _this2.start();\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: '__isStatic',\n\t    value: function __isStatic(pattern) {\n\t      return !pattern.match(/[[{]/);\n\t    }\n\t  }, {\n\t    key: '__routeRegExp',\n\t    value: function __routeRegExp(str) {\n\t      var chunks = str.split('[');\n\t\n\t      if (chunks.length > 2) {\n\t        throw new Error('Invalid use of optional params');\n\t      }\n\t\n\t      var tokens = [];\n\t      var re = chunks[0].replace(/{([^}]+)}/g, function (g, token) {\n\t        tokens.push(token);\n\t        return '([^/]+)';\n\t      }).replace(/\\//g, '\\\\/');\n\t\n\t      var optRe = '';\n\t\n\t      if (chunks[1]) {\n\t        optRe = '(?:' + chunks[1].slice(0, -1).replace(/{([^}]+)}/g, function (g, token) {\n\t          tokens.push(token);\n\t          return '([^/]+)';\n\t        }).replace(/\\//g, '\\\\/') + ')?';\n\t      }\n\t      return [new RegExp('^' + re + optRe + '$'), tokens];\n\t    }\n\t  }, {\n\t    key: 'route',\n\t    value: function route(_route, callback) {\n\t      var routeHandler = {\n\t        route: _route,\n\t        type: 's',\n\t        pattern: null,\n\t        args: [],\n\t        callback: callback\n\t      };\n\t\n\t      if (!this.__isStatic(_route)) {\n\t        var result = this.__routeRegExp(_route);\n\t\n\t        routeHandler.type = 'v';\n\t        routeHandler.pattern = result[0];\n\t        routeHandler.args = result[1];\n\t      }\n\t\n\t      this.handlers.push(routeHandler);\n\t\n\t      this.__awaitRouteCallback(this.getFragmentExecutors(this.getFragment()));\n\t    }\n\t  }, {\n\t    key: 'start',\n\t    value: function () {\n\t      var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n\t        var executed;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t          while (1) {\n\t            switch (_context.prev = _context.next) {\n\t              case 0:\n\t                if (!(this.__started || this.__starting)) {\n\t                  _context.next = 2;\n\t                  break;\n\t                }\n\t\n\t                return _context.abrupt('return');\n\t\n\t              case 2:\n\t\n\t                this.__middlewareChainRun = compose(this.middlewares);\n\t\n\t                console.info('Starting ' + this.is + ':' + this.__id + ' ...');\n\t\n\t                this.__starting = true;\n\t                _context.next = 7;\n\t                return this.__execute();\n\t\n\t              case 7:\n\t                executed = _context.sent;\n\t\n\t                this.__starting = false;\n\t\n\t                if (executed) {\n\t                  console.info('Started ' + this.is + ':' + this.__id);\n\t\n\t                  this.__started = true;\n\t\n\t                  this.__listenNavigation();\n\t\n\t                  this.fire('started');\n\t                }\n\t\n\t              case 10:\n\t              case 'end':\n\t                return _context.stop();\n\t            }\n\t          }\n\t        }, _callee, this);\n\t      }));\n\t\n\t      function start() {\n\t        return _ref.apply(this, arguments);\n\t      }\n\t\n\t      return start;\n\t    }()\n\t  }, {\n\t    key: '__listenNavigation',\n\t    value: function __listenNavigation() {\n\t      var _this3 = this;\n\t\n\t      var callback = function callback() {\n\t        _this3.__execute();\n\t      };\n\t\n\t      if (this.mode === 'history') {\n\t        _src2.default.event(window).on('popstate', callback);\n\t        _src2.default.event(document).on('click', function (evt) {\n\t          if (!evt.defaultPrevented && evt.target.nodeName === 'A' && evt.target.target === '') {\n\t            evt.preventDefault();\n\t\n\t            var state = { url: evt.target.getAttribute('href') };\n\t            _this3.history.pushState(state, evt.target.innerHTML, evt.target.href);\n\t\n\t            callback();\n\t          }\n\t        });\n\t      } else {\n\t        _src2.default.event(window).on('hashchange', callback);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getFragmentExecutors',\n\t    value: function getFragmentExecutors(fragment) {\n\t      return this.handlers.reduce(function (executors, handler) {\n\t        if (handler.type === 's') {\n\t          if (fragment === handler.route) {\n\t            executors.push({ handler: handler, args: {} });\n\t          }\n\t        } else if (handler.type === 'v') {\n\t          (function () {\n\t            var result = fragment.match(handler.pattern);\n\t            if (result) {\n\t              (function () {\n\t                var args = {};\n\t\n\t                handler.args.forEach(function (name, index) {\n\t                  args[name] = result[index + 1];\n\t                });\n\t\n\t                executors.push({\n\t                  handler: handler,\n\t                  args: args\n\t                });\n\t              })();\n\t            }\n\t          })();\n\t        }\n\t        return executors;\n\t      }, []);\n\t    }\n\t  }, {\n\t    key: '__waitForRoute',\n\t    value: function __waitForRoute() {\n\t      var _this4 = this;\n\t\n\t      return new Promise(function (resolve, reject) {\n\t        _this4.__awaitRouteCallback = function (executors) {\n\t          if (executors.length === 0) {\n\t            return;\n\t          }\n\t\n\t          _this4.__awaitRouteCallback = NOOP;\n\t          resolve(executors);\n\t        };\n\t      });\n\t    }\n\t  }, {\n\t    key: '__execute',\n\t    value: function () {\n\t      var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n\t        var fragment, executors, context;\n\t        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t          while (1) {\n\t            switch (_context2.prev = _context2.next) {\n\t              case 0:\n\t                fragment = this.getFragment();\n\t                executors = this.getFragmentExecutors(fragment);\n\t\n\t                if (!(executors.length === 0)) {\n\t                  _context2.next = 9;\n\t                  break;\n\t                }\n\t\n\t                if (!(this.__availableUris.indexOf(fragment) === -1)) {\n\t                  _context2.next = 6;\n\t                  break;\n\t                }\n\t\n\t                this.fire('route-not-found', fragment);\n\t                return _context2.abrupt('return', false);\n\t\n\t              case 6:\n\t                _context2.next = 8;\n\t                return this.__waitForRoute();\n\t\n\t              case 8:\n\t                executors = _context2.sent;\n\t\n\t              case 9:\n\t                context = { uri: fragment };\n\t\n\t\n\t                this.fire('navigated', context);\n\t\n\t                // run middleware chain then execute all executors\n\t                _context2.next = 13;\n\t                return this.__middlewareChainRun(context, function () {\n\t                  executors.forEach(function (executor) {\n\t                    executor.handler.callback(executor.args, context);\n\t                  });\n\t                });\n\t\n\t              case 13:\n\t                return _context2.abrupt('return', true);\n\t\n\t              case 14:\n\t              case 'end':\n\t                return _context2.stop();\n\t            }\n\t          }\n\t        }, _callee2, this);\n\t      }));\n\t\n\t      function __execute() {\n\t        return _ref2.apply(this, arguments);\n\t      }\n\t\n\t      return __execute;\n\t    }()\n\t  }, {\n\t    key: 'navigate',\n\t    value: function navigate(path, options) {\n\t      path = path || '/';\n\t      options = options || {};\n\t\n\t      if (this.mode === 'history') {\n\t        var url = this.rootUri + path.toString().replace(/\\/$/, '').replace(/^\\//, '');\n\t        if (this.location.href.replace(this.location.origin, '') !== url) {\n\t          this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n\t          this.__execute();\n\t        }\n\t      } else {\n\t        this.location.href.match(this.hashSeparator);\n\t        this.location.href = this.location.href.replace(this.hashSeparator, '') + this.hashSeparator + path;\n\t      }\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'use',\n\t    value: function use(middleware) {\n\t      this.middlewares.push(middleware);\n\t    }\n\t  }, {\n\t    key: 'getFragment',\n\t    value: function getFragment() {\n\t      try {\n\t        var fragment = void 0;\n\t        if (this.mode === 'history') {\n\t          fragment = decodeURI(this.location.pathname + this.location.search);\n\t          fragment = fragment.replace(/\\?(.*)$/, '');\n\t          fragment = this.rootUri === '/' ? fragment : fragment.replace(this.rootUri, '');\n\t        } else {\n\t          var match = this.location.href.match(this.hashSeparator);\n\t          fragment = match ? match[1] : '';\n\t        }\n\t\n\t        return '/' + fragment.toString().replace(/\\/$/, '').replace(/^\\//, '');\n\t      } catch (err) {\n\t        console.error('Fragment is not match any pattern, fallback to /');\n\t        return '/';\n\t      }\n\t    }\n\t\n\t    // $back (evt) {\n\t    //   evt.preventDefault();\n\t    //   this.history.back();\n\t    // }\n\t\n\t  }, {\n\t    key: 'props',\n\t    get: function get() {\n\t      return {\n\t        docTitle: {\n\t          type: String,\n\t          value: 'Application',\n\t          observer: '_titleChanged'\n\t        },\n\t\n\t        manual: {\n\t          type: Boolean\n\t        },\n\t\n\t        mode: {\n\t          type: String,\n\t          value: 'hash'\n\t        },\n\t\n\t        rootUri: {\n\t          type: String,\n\t          value: '/'\n\t        },\n\t\n\t        hashSeparator: {\n\t          type: RegExp,\n\t          value: function value() {\n\t            return (/#!(.*)$/\n\t            );\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'listeners',\n\t    get: function get() {\n\t      return {\n\t        'route-not-found': 'handleRouteNotFound(evt)'\n\t      };\n\t    }\n\t  }, {\n\t    key: 'started',\n\t    get: function get() {\n\t      return this.__started || false;\n\t    }\n\t  }]);\n\t\n\t  return App;\n\t}(_src2.default.Component);\n\t\n\t_src2.default.define('xin-app', App);\n\t\n\tfunction compose(middlewares) {\n\t  var _this5 = this;\n\t\n\t  var _iteratorNormalCompletion = true;\n\t  var _didIteratorError = false;\n\t  var _iteratorError = undefined;\n\t\n\t  try {\n\t    for (var _iterator = middlewares[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t      var fn = _step.value;\n\t\n\t      if (typeof fn !== 'function') {\n\t        throw new TypeError('Middleware must be composed of functions!');\n\t      }\n\t    }\n\t  } catch (err) {\n\t    _didIteratorError = true;\n\t    _iteratorError = err;\n\t  } finally {\n\t    try {\n\t      if (!_iteratorNormalCompletion && _iterator.return) {\n\t        _iterator.return();\n\t      }\n\t    } finally {\n\t      if (_didIteratorError) {\n\t        throw _iteratorError;\n\t      }\n\t    }\n\t  }\n\t\n\t  return function () {\n\t    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4(context, next) {\n\t      var dispatch = function () {\n\t        var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(i) {\n\t          var fn;\n\t          return regeneratorRuntime.wrap(function _callee3$(_context3) {\n\t            while (1) {\n\t              switch (_context3.prev = _context3.next) {\n\t                case 0:\n\t                  if (!(i <= index)) {\n\t                    _context3.next = 2;\n\t                    break;\n\t                  }\n\t\n\t                  throw new Error('next() called multiple times');\n\t\n\t                case 2:\n\t\n\t                  index = i;\n\t                  fn = middlewares[i];\n\t\n\t                  if (i === middlewares.length) {\n\t                    fn = next;\n\t                  }\n\t\n\t                  if (fn) {\n\t                    _context3.next = 7;\n\t                    break;\n\t                  }\n\t\n\t                  return _context3.abrupt('return');\n\t\n\t                case 7:\n\t                  _context3.next = 9;\n\t                  return fn(context, function () {\n\t                    return dispatch(i + 1);\n\t                  });\n\t\n\t                case 9:\n\t                  return _context3.abrupt('return', _context3.sent);\n\t\n\t                case 10:\n\t                case 'end':\n\t                  return _context3.stop();\n\t              }\n\t            }\n\t          }, _callee3, this);\n\t        }));\n\t\n\t        return function dispatch(_x3) {\n\t          return _ref4.apply(this, arguments);\n\t        };\n\t      }();\n\t\n\t      var index;\n\t      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n\t        while (1) {\n\t          switch (_context4.prev = _context4.next) {\n\t            case 0:\n\t              // last called middlewares #\n\t              index = -1;\n\t              return _context4.abrupt('return', dispatch(0));\n\t\n\t            case 2:\n\t            case 'end':\n\t              return _context4.stop();\n\t          }\n\t        }\n\t      }, _callee4, _this5);\n\t    }));\n\t\n\t    return function (_x, _x2) {\n\t      return _ref3.apply(this, arguments);\n\t    };\n\t  }();\n\t}\n\t\n\t_src2.default.App = App;\n\t\n\texports.default = App;\n\n/***/ }\n]);\n\n\n// WEBPACK FOOTER //\n// components/app.min.js","import xin from '../src';\n\nconst NOOP = () => {};\n\nclass App extends xin.Component {\n  get props () {\n    return {\n      docTitle: {\n        type: String,\n        value: 'Application',\n        observer: '_titleChanged',\n      },\n\n      manual: {\n        type: Boolean,\n      },\n\n      mode: {\n        type: String,\n        value: 'hash',\n      },\n\n      rootUri: {\n        type: String,\n        value: '/',\n      },\n\n      hashSeparator: {\n        type: RegExp,\n        value: () => /#!(.*)$/,\n      },\n    };\n  }\n\n  get listeners () {\n    return {\n      'route-not-found': 'handleRouteNotFound(evt)',\n    };\n  }\n\n  handleRouteNotFound (evt) {\n    console.error('Route not found: ' + evt.detail);\n  }\n\n  _titleChanged (title) {\n    document.title = title;\n  }\n\n  created () {\n    xin.put('app', this);\n\n    // this.classList.add('xin-app');\n\n    this.__appSignature = true;\n    this.location = window.location;\n    this.history = window.history;\n\n    // default values\n    this.handlers = [];\n    this.middlewares = [];\n\n    this.__awaitRouteCallback = NOOP;\n    this.__started = false;\n    this.__starting = false;\n  }\n\n  attached () {\n    if (!this.manual) {\n      this.async(() => {\n        this.__availableUris = [].map.call(this.querySelectorAll('.xin-view'), el => el.uri);\n        this.start();\n      });\n    }\n  }\n\n  __isStatic (pattern) {\n    return !pattern.match(/[[{]/);\n  }\n\n  __routeRegExp (str) {\n    let chunks = str.split('[');\n\n    if (chunks.length > 2) {\n      throw new Error('Invalid use of optional params');\n    }\n\n    let tokens = [];\n    let re = chunks[0].replace(/{([^}]+)}/g, function (g, token) {\n      tokens.push(token);\n      return '([^/]+)';\n    }).replace(/\\//g, '\\\\/');\n\n    let optRe = '';\n\n    if (chunks[1]) {\n      optRe = '(?:' + chunks[1].slice(0, -1).replace(/{([^}]+)}/g, function (g, token) {\n        tokens.push(token);\n        return '([^/]+)';\n      }).replace(/\\//g, '\\\\/') + ')?';\n    }\n    return [ new RegExp('^' + re + optRe + '$'), tokens ];\n  }\n\n  route (route, callback) {\n    let routeHandler = {\n      route: route,\n      type: 's',\n      pattern: null,\n      args: [],\n      callback: callback,\n    };\n\n    if (!this.__isStatic(route)) {\n      let result = this.__routeRegExp(route);\n\n      routeHandler.type = 'v';\n      routeHandler.pattern = result[0];\n      routeHandler.args = result[1];\n    }\n\n    this.handlers.push(routeHandler);\n\n    this.__awaitRouteCallback(this.getFragmentExecutors(this.getFragment()));\n  }\n\n  async start () {\n    if (this.__started || this.__starting) {\n      return;\n    }\n\n    this.__middlewareChainRun = compose(this.middlewares);\n\n    console.info(`Starting ${this.is}:${this.__id} ...`);\n\n    this.__starting = true;\n    let executed = await this.__execute();\n    this.__starting = false;\n\n    if (executed) {\n      console.info(`Started ${this.is}:${this.__id}`);\n\n      this.__started = true;\n\n      this.__listenNavigation();\n\n      this.fire('started');\n    }\n  }\n\n  __listenNavigation () {\n    let callback = () => {\n      this.__execute();\n    };\n\n    if (this.mode === 'history') {\n      xin.event(window).on('popstate', callback);\n      xin.event(document).on('click', evt => {\n        if (!evt.defaultPrevented && evt.target.nodeName === 'A' && evt.target.target === '') {\n          evt.preventDefault();\n\n          let state = { url: evt.target.getAttribute('href') };\n          this.history.pushState(state, evt.target.innerHTML, evt.target.href);\n\n          callback();\n        }\n      });\n    } else {\n      xin.event(window).on('hashchange', callback);\n    }\n  }\n\n  get started () {\n    return this.__started || false;\n  }\n\n  getFragmentExecutors (fragment) {\n    return this.handlers.reduce((executors, handler) => {\n      if (handler.type === 's') {\n        if (fragment === handler.route) {\n          executors.push({ handler: handler, args: {} });\n        }\n      } else if (handler.type === 'v') {\n        let result = fragment.match(handler.pattern);\n        if (result) {\n          let args = {};\n\n          handler.args.forEach(function (name, index) {\n            args[name] = result[index + 1];\n          });\n\n          executors.push({\n            handler: handler,\n            args: args,\n          });\n        }\n      }\n      return executors;\n    }, []);\n  }\n\n  __waitForRoute () {\n    return new Promise((resolve, reject) => {\n      this.__awaitRouteCallback = (executors) => {\n        if (executors.length === 0) {\n          return;\n        }\n\n        this.__awaitRouteCallback = NOOP;\n        resolve(executors);\n      };\n    });\n  }\n\n  async __execute () {\n    let fragment = this.getFragment();\n    let executors = this.getFragmentExecutors(fragment);\n    if (executors.length === 0) {\n      if (this.__availableUris.indexOf(fragment) === -1) {\n        this.fire('route-not-found', fragment);\n        return false;\n      }\n\n      executors = await this.__waitForRoute();\n    }\n\n    let context = { uri: fragment };\n\n    this.fire('navigated', context);\n\n    // run middleware chain then execute all executors\n    await this.__middlewareChainRun(context, () => {\n      executors.forEach(executor => {\n        executor.handler.callback(executor.args, context);\n      });\n    });\n\n    return true;\n  }\n\n  navigate (path, options) {\n    path = path || '/';\n    options = options || {};\n\n    if (this.mode === 'history') {\n      let url = this.rootUri + path.toString().replace(/\\/$/, '').replace(/^\\//, '');\n      if (this.location.href.replace(this.location.origin, '') !== url) {\n        this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n        this.__execute();\n      }\n    } else {\n      this.location.href.match(this.hashSeparator);\n      this.location.href = this.location.href.replace(this.hashSeparator, '') + this.hashSeparator + path;\n    }\n    return this;\n  }\n\n  use (middleware) {\n    this.middlewares.push(middleware);\n  }\n\n  getFragment () {\n    try {\n      let fragment;\n      if (this.mode === 'history') {\n        fragment = decodeURI(this.location.pathname + this.location.search);\n        fragment = fragment.replace(/\\?(.*)$/, '');\n        fragment = this.rootUri === '/' ? fragment : fragment.replace(this.rootUri, '');\n      } else {\n        let match = this.location.href.match(this.hashSeparator);\n        fragment = match ? match[1] : '';\n      }\n\n      return '/' + fragment.toString().replace(/\\/$/, '').replace(/^\\//, '');\n    } catch (err) {\n      console.error('Fragment is not match any pattern, fallback to /');\n      return '/';\n    }\n  }\n\n  // $back (evt) {\n  //   evt.preventDefault();\n  //   this.history.back();\n  // }\n}\n\nxin.define('xin-app', App);\n\nfunction compose (middlewares) {\n  for (const fn of middlewares) {\n    if (typeof fn !== 'function') {\n      throw new TypeError('Middleware must be composed of functions!');\n    }\n  }\n\n  return async (context, next) => {\n    // last called middlewares #\n    let index = -1;\n\n    async function dispatch (i) {\n      if (i <= index) {\n        throw new Error('next() called multiple times');\n      }\n\n      index = i;\n      let fn = middlewares[i];\n      if (i === middlewares.length) {\n        fn = next;\n      }\n      if (!fn) {\n        return;\n      }\n\n      return await fn(context, () => dispatch(i + 1));\n    }\n\n    return dispatch(0);\n  };\n}\n\nxin.App = App;\n\nexport default App;\n\n\n\n// WEBPACK FOOTER //\n// ./components/app.js"],"sourceRoot":""}
{"version":3,"sources":["webpack:///components/app.min.js","webpack:///./components/app.js"],"names":["webpackJsonp","module","exports","__webpack_require__","_asyncToGenerator","fn","gen","apply","this","arguments","Promise","resolve","reject","step","key","arg","info","value","error","done","then","err","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","compose","middlewares","_this3","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","_ref3","regeneratorRuntime","mark","_callee4","context","index","dispatch","_ref4","_callee3","i","wrap","_context3","prev","Error","length","abrupt","sent","stop","_x3","_context4","_x","_x2","_createClass","defineProperties","target","props","descriptor","defineProperty","protoProps","staticProps","xin","App","_xin$Component","getPrototypeOf","evt","console","detail","title","document","put","__appSignature","location","window","history","handlers","__started","hashSeparator","reHashSeparator","RegExp","manual","async","start","pattern","match","str","chunks","split","tokens","re","replace","g","token","push","optRe","slice","route","callback","routeHandler","type","args","__isStatic","result","__routeRegExp","_ref","_callee","executed","_context","__middlewareChainRun","__execute","__getId","__listenNavigation","fire","_this2","__executeCallback","mode","addEventListener","defaultPrevented","nodeName","preventDefault","state","url","getAttribute","pushState","innerHTML","href","bind","fragment","getFragment","reduce","executors","handler","forEach","name","_ref2","_callee2","_context2","getFragmentExecutors","uri","executor","path","options","rootUri","toString","origin","middleware","decodeURI","pathname","search","get","docTitle","String","observer","Boolean","route-not-found","Component","define"],"mappings":"AAAAA,cAAc,IAER,SAASC,EAAQC,EAASC,GAE/B,YAIA,SAASC,GAAkBC,GAAM,MAAO,YAAc,GAAIC,GAAMD,EAAGE,MAAMC,KAAMC,UAAY,OAAO,IAAIC,SAAQ,SAAUC,EAASC,GAAU,QAASC,GAAKC,EAAKC,GAAO,IAAM,GAAIC,GAAOV,EAAIQ,GAAKC,GAAUE,EAAQD,EAAKC,MAAS,MAAOC,GAAwB,WAAfN,GAAOM,GAAkB,MAAIF,GAAKG,SAAQR,GAAQM,GAAwBP,QAAQC,QAAQM,GAAOG,KAAK,SAAUH,GAASJ,EAAK,OAAQI,IAAW,SAAUI,GAAOR,EAAK,QAASQ,KAAc,MAAOR,GAAK,WAEzb,QAASS,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMC,GAAQ,IAAKD,EAAQ,KAAM,IAAIE,gBAAe,4DAAgE,QAAOD,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BD,EAAPC,EAElO,QAASE,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIP,WAAU,iEAAoEO,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAenB,MAAOc,EAAUM,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeP,IAAYE,OAAOM,eAAiBN,OAAOM,eAAeT,EAAUC,GAAcD,EAASU,UAAYT,GCsPle,QAASU,GAASC,GAAa,GAAAC,GAAApC,KAAAqC,GAAA,EAAAC,GAAA,EAAAC,EAAAC,MAAA,KAC7B,OAAAC,GAAAC,EAAiBP,EAAjBQ,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAlC,MAAA0B,GAAA,EAA8B,IAAnBxC,GAAmB4C,EAAAhC,KAC5B,IAAkB,kBAAPZ,GACT,KAAM,IAAIoB,WAAU,8CAHK,MAAAJ,GAAAyB,GAAA,EAAAC,EAAA1B,EAAA,aAAAwB,GAAAK,2BAAA,WAAAJ,EAAA,KAAAC,IAO7B,qBAAAO,GAAAlD,EAAAmD,mBAAAC,KAAO,QAAAC,GAAOC,EAASL,GAAhB,GAAAM,GAAAC,EAAA,cAAAC,GAAAzD,EAAAmD,mBAAAC,KAIL,QAAAM,GAAyBC,GAAzB,GAAA1D,EAAA,OAAAkD,oBAAAS,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAZ,MAAA,YACMU,GAAKJ,GADX,CAAAM,EAAAZ,KAAA,aAEU,IAAIc,OAAM,+BAFpB,WAKER,EAAQI,EACJ1D,EAAKsC,EAAYoB,GACjBA,IAAMpB,EAAYyB,SACpB/D,EAAKgD,GAEFhD,EAVP,CAAA4D,EAAAZ,KAAA,cAAAY,GAAAI,OAAA,uBAAAJ,GAAAZ,KAAA,EAcehD,EAAGqD,EAAS,iBAAME,GAASG,EAAI,IAd9C,cAAAE,GAAAI,OAAA,SAAAJ,EAAAK,KAAA,yBAAAL,GAAAM,SAAAT,EAAAtD,QAJK,iBAAAgE,GAAA,MAAAX,GAAAtD,MAAAC,KAAAC,cAAA,OAAA8C,oBAAAS,KAAA,SAAAS,GAAA,cAAAA,EAAAP,KAAAO,EAAApB,MAAA,aAEDM,MAFCc,EAAAJ,OAAA,SAqBET,EAAS,GArBX,wBAAAa,GAAAF,SAAAd,EAAAb,KAAP,iBAAA8B,EAAAC,GAAA,MAAArB,GAAA/C,MAAAC,KAAAC,eDrQD,GAAImE,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIhB,GAAI,EAAGA,EAAIgB,EAAMX,OAAQL,IAAK,CAAE,GAAIiB,GAAaD,EAAMhB,EAAIiB,GAAW3C,WAAa2C,EAAW3C,aAAc,EAAO2C,EAAWzC,cAAe,EAAU,SAAWyC,KAAYA,EAAW1C,UAAW,GAAMJ,OAAO+C,eAAeH,EAAQE,EAAWlE,IAAKkE,IAAiB,MAAO,UAAUxD,EAAa0D,EAAYC,GAAiJ,MAA9HD,IAAYL,EAAiBrD,EAAYS,UAAWiD,GAAiBC,GAAaN,EAAiBrD,EAAa2D,GAAqB3D,MCN3hB4D,EAAMjF,EAAQ,GAEdkF,EDgBK,SAAUC,GAGlB,QAASD,KAGP,MAFA/D,GAAgBd,KAAM6E,GAEf3D,EAA2BlB,MAAO6E,EAAI5C,WAAaP,OAAOqD,eAAeF,IAAM9E,MAAMC,KAAMC,YAuVpG,MA5VAqB,GAAUuD,EAAKC,GAQfV,EAAaS,IACXvE,IAAK,sBACLG,MAAO,SCUWuE,GACnBC,QAAQvE,MAAM,oBAAsBsE,EAAIE,WDPvC5E,IAAK,gBACLG,MAAO,SCSK0E,GACbC,SAASD,MAAQA,KDNhB7E,IAAK,UACLG,MAAO,WCSRmE,EAAIS,IAAI,MAAOrF,MAIfA,KAAKsF,gBAAiB,EACtBtF,KAAKuF,SAAWC,OAAOD,SACvBvF,KAAKyF,QAAUD,OAAOC,QAGtBzF,KAAK0F,YACL1F,KAAKmC,eAELnC,KAAK2F,WAAY,KDLhBrF,IAAK,wBACLG,MAAO,SCOamF,GACrB5F,KAAK6F,gBAAkB,GAAIC,QAAOF,EAAgB,YDJjDtF,IAAK,WACLG,MAAO,WCOHT,KAAK+F,QACR/F,KAAKgG,MAAMhG,KAAKiG,UDFjB3F,IAAK,aACLG,MAAO,SCKEyF,GACV,OAAQA,EAAQC,MAAM,WDFrB7F,IAAK,gBACLG,MAAO,SCIK2F,GACb,GAAIC,GAASD,EAAIE,MAAM,IAEvB,IAAID,EAAOzC,OAAS,EAClB,KAAM,IAAID,OAAM,iCAGlB,IAAI4C,MACAC,EAAKH,EAAO,GAAGI,QAAQ,aAAc,SAAUC,EAAGC,GAEpD,MADAJ,GAAOK,KAAKD,GACL,YACNF,QAAQ,MAAO,OAEdI,EAAQ,EAQZ,OANIR,GAAO,KACTQ,EAAQ,MAAQR,EAAO,GAAGS,MAAM,MAAOL,QAAQ,aAAc,SAAUC,EAAGC,GAExE,MADAJ,GAAOK,KAAKD,GACL,YACNF,QAAQ,MAAO,OAAS,OAEpB,GAAIX,QAAO,IAAMU,EAAKK,EAAQ,KAAMN,MDD5CjG,IAAK,QACLG,MAAO,SCGHsG,EAAOC,GACZ,GAAIC,IACFF,MAAOA,EACPG,KAAM,IACNhB,QAAS,KACTiB,QACAH,SAAUA,EAGZ,KAAKhH,KAAKoH,WAAWL,GAAQ,CAC3B,GAAIM,GAASrH,KAAKsH,cAAcP,EAEhCE,GAAaC,KAAO,IACpBD,EAAaf,QAAUmB,EAAO,GAC9BJ,EAAaE,KAAOE,EAAO,GAG7BrH,KAAK0F,SAASkB,KAAKK,MDAlB3G,IAAK,QACLG,MAAO,WA6CL,QAASwF,KACP,MAAOsB,GAAKxH,MAAMC,KAAMC,WA7C1B,GAAIsH,GAAO3H,EAAkBmD,mBAAmBC,KAAK,QAASwE,KAC5D,GAAIC,EACJ,OAAO1E,oBAAmBS,KAAK,SAAkBkE,GAC/C,OACE,OAAQA,EAAShE,KAAOgE,EAAS7E,MAC/B,IAAK,GACH,ICJT7C,KAAK2F,UDIyB,CACnB+B,EAAS7E,KAAO,CAChB,OAGF,MAAO6E,GAAS7D,OAAO,SAEzB,KAAK,GAMH,MCbb7D,MAAK2H,qBAAuBzF,EAAQlC,KAAKmC,aDY5BuF,EAAS7E,KAAO,ECTR7C,KAAK4H,WDYf,KAAK,GCZZH,EDaoBC,EAAS5D,KCV7B2D,IACFxC,QAAQzE,KAAR,cAA2BR,KAAK6H,WAEhC7H,KAAK2F,WAAY,EAEjB3F,KAAK8H,qBAEL9H,KAAK+H,KAAK,WDiBD,KAAK,GACL,IAAK,MACH,MAAOL,GAAS3D,SAGrByD,EAASxH,QAOd,OAAOiG,QAGT3F,IAAK,qBACLG,MAAO,WC7BY,GAAAuH,GAAAhI,KAChBgH,EAAWhH,KAAKiI,kBAAoB,WACtCD,EAAKJ,YAGW,aAAd5H,KAAKkI,MACP1C,OAAO2C,iBAAiB,WAAYnB,GAAU,GAC9C5B,SAAS+C,iBAAiB,QAAS,SAAUnD,GAC3C,IAAKA,EAAIoD,kBAA4C,MAAxBpD,EAAIV,OAAO+D,UAA0C,KAAtBrD,EAAIV,OAAOA,OAAe,CACpFU,EAAIsD,gBAEJ,IAAIC,IAAUC,IAAKxD,EAAIV,OAAOmE,aAAa,QAC3CzI,MAAKyF,QAAQiD,UAAUH,EAAOvD,EAAIV,OAAOqE,UAAW3D,EAAIV,OAAOsE,MAE/D5B,MAEF6B,KAAK7I,QAEPwF,OAAO2C,iBAAiB,aAAcnB,GAAU,MDmCjD1G,IAAK,uBACLG,MAAO,SC5BYqI,GAGpB,MAFAA,GAAWA,GAAY9I,KAAK+I,cAErB/I,KAAK0F,SAASsD,OAAO,SAACC,EAAWC,GAoBtC,MAnBqB,MAAjBA,EAAQhC,KACN4B,IAAaI,EAAQnC,OACvBkC,EAAUrC,MAAOsC,QAASA,EAAS/B,UAEX,MAAjB+B,EAAQhC,OAAc,WAC/B,GAAIG,GAASyB,EAAS3C,MAAM+C,EAAQhD,QAChCmB,KAAQ,WACV,GAAIF,KAEJ+B,GAAQ/B,KAAKgC,QAAQ,SAAUC,EAAMjG,GACnCgE,EAAKiC,GAAQ/B,EAAOlE,EAAQ,KAG9B8F,EAAUrC,MACRsC,QAASA,EACT/B,KAAMA,UAIL8B,UDoCR3I,IAAK,YACLG,MAAO,WA2CL,QAASmH,KACP,MAAOyB,GAAMtJ,MAAMC,KAAMC,WA3C3B,GAAIoJ,GAAQzJ,EAAkBmD,mBAAmBC,KAAK,QAASsG,KAC7D,GAAIR,GAAUG,EAAW/F,CACzB,OAAOH,oBAAmBS,KAAK,SAAmB+F,GAChD,OACE,OAAQA,EAAU7F,KAAO6F,EAAU1G,MACjC,IAAK,GAIH,GC1CTiG,EAAW9I,KAAK+I,cAEhBE,EAAYjJ,KAAKwJ,qBAAqBV,GACjB,IAArBG,EAAUrF,ODuC8B,CAC7B2F,EAAU1G,KAAO,CACjB,OAIF,MC5CX7C,MAAK+H,KAAK,kBAAmBe,GD4CXS,EAAU1F,OAAO,UC3C5B,ED6CE,KAAK,GAQH,MClDTX,IAAYuG,IAAKX,GAErB9I,KAAK+H,KAAK,YAAa7E,GD+CVqG,EAAU1G,KAAO,EC5CxB7C,KAAK2H,qBAAqBzE,EAAS,WACvC+F,EAAUE,QAAQ,SAAAO,GAAA,MAAYA,GAASR,QAAQlC,SAAS0C,EAASvC,KAAMjE,MDkD9D,KAAK,GACH,MAAOqG,GAAU1F,OAAO,UChD9B,EDkDI,KAAK,IACL,IAAK,MACH,MAAO0F,GAAUxF,SAGtBuF,EAAUtJ,QAOf,OAAO4H,QAGTtH,IAAK,WACLG,MAAO,SC/DAkJ,EAAMC,GAId,GAHAD,EAAOA,GAAQ,IACfC,EAAUA,MAEQ,YAAd5J,KAAKkI,KAAoB,CAC3B,GAAIM,GAAMxI,KAAK6J,QAAUF,EAAKG,WAAWrD,QAAQ,MAAO,IAAIA,QAAQ,MAAO,GACvEzG,MAAKuF,SAASqD,KAAKnC,QAAQzG,KAAKuF,SAASwE,OAAQ,MAAQvB,IAC3DxI,KAAKyF,QAAQmE,EAAQnD,QAAU,eAAiB,gBAAiBrB,SAASD,MAAOqD,GACjFxI,KAAK4H,iBAGP5H,MAAKuF,SAASqD,KAAKzC,MAAMnG,KAAK6F,iBAC9B7F,KAAKuF,SAASqD,KAAO5I,KAAKuF,SAASqD,KAAKnC,QAAQzG,KAAK6F,gBAAiB,IAAM7F,KAAK4F,cAAgB+D,CAEnG,OAAO3J,SDkENM,IAAK,MACLG,MAAO,SChELuJ,GACHhK,KAAKmC,YAAYyE,KAAKoD,MDmErB1J,IAAK,cACLG,MAAO,WChER,GAAIqI,SACJ,IAAkB,YAAd9I,KAAKkI,KACPY,EAAWmB,UAAUjK,KAAKuF,SAAS2E,SAAWlK,KAAKuF,SAAS4E,QAC5DrB,EAAWA,EAASrC,QAAQ,UAAW,IACvCqC,EAA4B,MAAjB9I,KAAK6J,QAAkBf,EAAWA,EAASrC,QAAQzG,KAAK6J,QAAS,QACvE,CACL,GAAI1D,GAAQnG,KAAKuF,SAASqD,KAAKzC,MAAMnG,KAAK6F,gBAC1CiD,GAAW3C,EAAQA,EAAM,GAAK,GAGhC,MAAO,IAAM2C,EAASgB,WAAWrD,QAAQ,MAAO,IAAIA,QAAQ,MAAO,OD0ElEnG,IAAK,QACL8J,IAAK,WChUN,OACEC,UACEnD,KAAMoD,OACN7J,MAAO,cACP8J,SAAU,iBAGZxE,QACEmB,KAAMsD,SAGRtC,MACEhB,KAAMoD,OACN7J,MAAO,QAGToJ,SACE3C,KAAMoD,OACN7J,MAAO,KAGTmF,eACEsB,KAAMoD,OACN7J,MAAO,KACP8J,SAAU,6BDsUbjK,IAAK,YACL8J,IAAK,WCjUN,OACEK,kBAAmB,+BDsUpBnK,IAAK,UACL8J,IAAK,WCpMN,MAAOpK,MAAK2F,YAAa,MDyMnBd,GC7WQD,EAAI8F,UAgQtB9F,GAAI+F,OAAO,UAAW9F,GAkCtBD,EAAIC,IAAMA,EAEVpF,EAAOC,QAAUmF","file":"components/app.min.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar xin = __webpack_require__(1);\n\t\n\tvar App = function (_xin$Component) {\n\t  _inherits(App, _xin$Component);\n\t\n\t  function App() {\n\t    _classCallCheck(this, App);\n\t\n\t    return _possibleConstructorReturn(this, (App.__proto__ || Object.getPrototypeOf(App)).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(App, [{\n\t    key: 'handleRouteNotFound',\n\t    value: function handleRouteNotFound(evt) {\n\t      console.error('Route not found: ' + evt.detail);\n\t    }\n\t  }, {\n\t    key: '_titleChanged',\n\t    value: function _titleChanged(title) {\n\t      document.title = title;\n\t    }\n\t  }, {\n\t    key: 'created',\n\t    value: function created() {\n\t      xin.put('app', this);\n\t\n\t      // this.classList.add('xin-app');\n\t\n\t      this.__appSignature = true;\n\t      this.location = window.location;\n\t      this.history = window.history;\n\t\n\t      // default values\n\t      this.handlers = [];\n\t      this.middlewares = [];\n\t\n\t      this.__started = false;\n\t    }\n\t  }, {\n\t    key: '_hashSeparatorChanged',\n\t    value: function _hashSeparatorChanged(hashSeparator) {\n\t      this.reHashSeparator = new RegExp(hashSeparator + '(.*)$');\n\t    }\n\t  }, {\n\t    key: 'attached',\n\t    value: function attached() {\n\t      if (!this.manual) {\n\t        this.async(this.start);\n\t      }\n\t    }\n\t  }, {\n\t    key: '__isStatic',\n\t    value: function __isStatic(pattern) {\n\t      return !pattern.match(/[[{]/);\n\t    }\n\t  }, {\n\t    key: '__routeRegExp',\n\t    value: function __routeRegExp(str) {\n\t      var chunks = str.split('[');\n\t\n\t      if (chunks.length > 2) {\n\t        throw new Error('Invalid use of optional params');\n\t      }\n\t\n\t      var tokens = [];\n\t      var re = chunks[0].replace(/{([^}]+)}/g, function (g, token) {\n\t        tokens.push(token);\n\t        return '([^/]+)';\n\t      }).replace(/\\//g, '\\\\/');\n\t\n\t      var optRe = '';\n\t\n\t      if (chunks[1]) {\n\t        optRe = '(?:' + chunks[1].slice(0, -1).replace(/{([^}]+)}/g, function (g, token) {\n\t          tokens.push(token);\n\t          return '([^/]+)';\n\t        }).replace(/\\//g, '\\\\/') + ')?';\n\t      }\n\t      return [new RegExp('^' + re + optRe + '$'), tokens];\n\t    }\n\t  }, {\n\t    key: 'route',\n\t    value: function route(_route, callback) {\n\t      var routeHandler = {\n\t        route: _route,\n\t        type: 's',\n\t        pattern: null,\n\t        args: [],\n\t        callback: callback\n\t      };\n\t\n\t      if (!this.__isStatic(_route)) {\n\t        var result = this.__routeRegExp(_route);\n\t\n\t        routeHandler.type = 'v';\n\t        routeHandler.pattern = result[0];\n\t        routeHandler.args = result[1];\n\t      }\n\t\n\t      this.handlers.push(routeHandler);\n\t    }\n\t  }, {\n\t    key: 'start',\n\t    value: function () {\n\t      var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n\t        var executed;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t          while (1) {\n\t            switch (_context.prev = _context.next) {\n\t              case 0:\n\t                if (!this.__started) {\n\t                  _context.next = 2;\n\t                  break;\n\t                }\n\t\n\t                return _context.abrupt('return');\n\t\n\t              case 2:\n\t\n\t                this.__middlewareChainRun = compose(this.middlewares);\n\t\n\t                // this.__starting = true;\n\t                _context.next = 5;\n\t                return this.__execute();\n\t\n\t              case 5:\n\t                executed = _context.sent;\n\t\n\t                // this.__starting = false;\n\t\n\t                if (executed) {\n\t                  console.info('Started    ' + this.__getId());\n\t\n\t                  this.__started = true;\n\t\n\t                  this.__listenNavigation();\n\t\n\t                  this.fire('started');\n\t                }\n\t\n\t              case 7:\n\t              case 'end':\n\t                return _context.stop();\n\t            }\n\t          }\n\t        }, _callee, this);\n\t      }));\n\t\n\t      function start() {\n\t        return _ref.apply(this, arguments);\n\t      }\n\t\n\t      return start;\n\t    }()\n\t  }, {\n\t    key: '__listenNavigation',\n\t    value: function __listenNavigation() {\n\t      var _this2 = this;\n\t\n\t      var callback = this.__executeCallback = function () {\n\t        _this2.__execute();\n\t      };\n\t\n\t      if (this.mode === 'history') {\n\t        window.addEventListener('popstate', callback, false);\n\t        document.addEventListener('click', function (evt) {\n\t          if (!evt.defaultPrevented && evt.target.nodeName === 'A' && evt.target.target === '') {\n\t            evt.preventDefault();\n\t\n\t            var state = { url: evt.target.getAttribute('href') };\n\t            this.history.pushState(state, evt.target.innerHTML, evt.target.href);\n\t\n\t            callback();\n\t          }\n\t        }.bind(this));\n\t      } else {\n\t        window.addEventListener('hashchange', callback, false);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getFragmentExecutors',\n\t    value: function getFragmentExecutors(fragment) {\n\t      fragment = fragment || this.getFragment();\n\t\n\t      return this.handlers.reduce(function (executors, handler) {\n\t        if (handler.type === 's') {\n\t          if (fragment === handler.route) {\n\t            executors.push({ handler: handler, args: {} });\n\t          }\n\t        } else if (handler.type === 'v') {\n\t          (function () {\n\t            var result = fragment.match(handler.pattern);\n\t            if (result) {\n\t              (function () {\n\t                var args = {};\n\t\n\t                handler.args.forEach(function (name, index) {\n\t                  args[name] = result[index + 1];\n\t                });\n\t\n\t                executors.push({\n\t                  handler: handler,\n\t                  args: args\n\t                });\n\t              })();\n\t            }\n\t          })();\n\t        }\n\t        return executors;\n\t      }, []);\n\t    }\n\t  }, {\n\t    key: '__execute',\n\t    value: function () {\n\t      var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n\t        var fragment, executors, context;\n\t        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t          while (1) {\n\t            switch (_context2.prev = _context2.next) {\n\t              case 0:\n\t                fragment = this.getFragment();\n\t                executors = this.getFragmentExecutors(fragment);\n\t\n\t                if (!(executors.length === 0)) {\n\t                  _context2.next = 5;\n\t                  break;\n\t                }\n\t\n\t                this.fire('route-not-found', fragment);\n\t                return _context2.abrupt('return', false);\n\t\n\t              case 5:\n\t                context = { uri: fragment };\n\t\n\t\n\t                this.fire('navigated', context);\n\t\n\t                // run middleware chain then execute all executors\n\t                _context2.next = 9;\n\t                return this.__middlewareChainRun(context, function () {\n\t                  executors.forEach(function (executor) {\n\t                    return executor.handler.callback(executor.args, context);\n\t                  });\n\t                });\n\t\n\t              case 9:\n\t                return _context2.abrupt('return', true);\n\t\n\t              case 10:\n\t              case 'end':\n\t                return _context2.stop();\n\t            }\n\t          }\n\t        }, _callee2, this);\n\t      }));\n\t\n\t      function __execute() {\n\t        return _ref2.apply(this, arguments);\n\t      }\n\t\n\t      return __execute;\n\t    }()\n\t  }, {\n\t    key: 'navigate',\n\t    value: function navigate(path, options) {\n\t      path = path || '/';\n\t      options = options || {};\n\t\n\t      if (this.mode === 'history') {\n\t        var url = this.rootUri + path.toString().replace(/\\/$/, '').replace(/^\\//, '');\n\t        if (this.location.href.replace(this.location.origin, '') !== url) {\n\t          this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n\t          this.__execute();\n\t        }\n\t      } else {\n\t        this.location.href.match(this.reHashSeparator);\n\t        this.location.href = this.location.href.replace(this.reHashSeparator, '') + this.hashSeparator + path;\n\t      }\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'use',\n\t    value: function use(middleware) {\n\t      this.middlewares.push(middleware);\n\t    }\n\t  }, {\n\t    key: 'getFragment',\n\t    value: function getFragment() {\n\t      var fragment = void 0;\n\t      if (this.mode === 'history') {\n\t        fragment = decodeURI(this.location.pathname + this.location.search);\n\t        fragment = fragment.replace(/\\?(.*)$/, '');\n\t        fragment = this.rootUri === '/' ? fragment : fragment.replace(this.rootUri, '');\n\t      } else {\n\t        var match = this.location.href.match(this.reHashSeparator);\n\t        fragment = match ? match[1] : '';\n\t      }\n\t\n\t      return '/' + fragment.toString().replace(/\\/$/, '').replace(/^\\//, '');\n\t    }\n\t\n\t    // $back (evt) {\n\t    //   evt.preventDefault();\n\t    //   this.history.back();\n\t    // }\n\t\n\t  }, {\n\t    key: 'props',\n\t    get: function get() {\n\t      return {\n\t        docTitle: {\n\t          type: String,\n\t          value: 'Application',\n\t          observer: '_titleChanged'\n\t        },\n\t\n\t        manual: {\n\t          type: Boolean\n\t        },\n\t\n\t        mode: {\n\t          type: String,\n\t          value: 'hash'\n\t        },\n\t\n\t        rootUri: {\n\t          type: String,\n\t          value: '/'\n\t        },\n\t\n\t        hashSeparator: {\n\t          type: String,\n\t          value: '#!',\n\t          observer: '_hashSeparatorChanged'\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'listeners',\n\t    get: function get() {\n\t      return {\n\t        'route-not-found': 'handleRouteNotFound(evt)'\n\t      };\n\t    }\n\t  }, {\n\t    key: 'started',\n\t    get: function get() {\n\t      return this.__started || false;\n\t    }\n\t  }]);\n\t\n\t  return App;\n\t}(xin.Component);\n\t\n\txin.define('xin-app', App);\n\t\n\tfunction compose(middlewares) {\n\t  var _this3 = this;\n\t\n\t  var _iteratorNormalCompletion = true;\n\t  var _didIteratorError = false;\n\t  var _iteratorError = undefined;\n\t\n\t  try {\n\t    for (var _iterator = middlewares[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t      var fn = _step.value;\n\t\n\t      if (typeof fn !== 'function') {\n\t        throw new TypeError('Middleware must be composed of functions!');\n\t      }\n\t    }\n\t  } catch (err) {\n\t    _didIteratorError = true;\n\t    _iteratorError = err;\n\t  } finally {\n\t    try {\n\t      if (!_iteratorNormalCompletion && _iterator.return) {\n\t        _iterator.return();\n\t      }\n\t    } finally {\n\t      if (_didIteratorError) {\n\t        throw _iteratorError;\n\t      }\n\t    }\n\t  }\n\t\n\t  return function () {\n\t    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4(context, next) {\n\t      var dispatch = function () {\n\t        var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(i) {\n\t          var fn;\n\t          return regeneratorRuntime.wrap(function _callee3$(_context3) {\n\t            while (1) {\n\t              switch (_context3.prev = _context3.next) {\n\t                case 0:\n\t                  if (!(i <= index)) {\n\t                    _context3.next = 2;\n\t                    break;\n\t                  }\n\t\n\t                  throw new Error('next() called multiple times');\n\t\n\t                case 2:\n\t\n\t                  index = i;\n\t                  fn = middlewares[i];\n\t\n\t                  if (i === middlewares.length) {\n\t                    fn = next;\n\t                  }\n\t\n\t                  if (fn) {\n\t                    _context3.next = 7;\n\t                    break;\n\t                  }\n\t\n\t                  return _context3.abrupt('return');\n\t\n\t                case 7:\n\t                  _context3.next = 9;\n\t                  return fn(context, function () {\n\t                    return dispatch(i + 1);\n\t                  });\n\t\n\t                case 9:\n\t                  return _context3.abrupt('return', _context3.sent);\n\t\n\t                case 10:\n\t                case 'end':\n\t                  return _context3.stop();\n\t              }\n\t            }\n\t          }, _callee3, this);\n\t        }));\n\t\n\t        return function dispatch(_x3) {\n\t          return _ref4.apply(this, arguments);\n\t        };\n\t      }();\n\t\n\t      var index;\n\t      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n\t        while (1) {\n\t          switch (_context4.prev = _context4.next) {\n\t            case 0:\n\t              // last called middlewares #\n\t              index = -1;\n\t              return _context4.abrupt('return', dispatch(0));\n\t\n\t            case 2:\n\t            case 'end':\n\t              return _context4.stop();\n\t          }\n\t        }\n\t      }, _callee4, _this3);\n\t    }));\n\t\n\t    return function (_x, _x2) {\n\t      return _ref3.apply(this, arguments);\n\t    };\n\t  }();\n\t}\n\t\n\txin.App = App;\n\t\n\tmodule.exports = App;\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** components/app.min.js\n **/","const xin = require('../src');\n\nclass App extends xin.Component {\n  get props () {\n    return {\n      docTitle: {\n        type: String,\n        value: 'Application',\n        observer: '_titleChanged',\n      },\n\n      manual: {\n        type: Boolean,\n      },\n\n      mode: {\n        type: String,\n        value: 'hash',\n      },\n\n      rootUri: {\n        type: String,\n        value: '/',\n      },\n\n      hashSeparator: {\n        type: String,\n        value: '#!',\n        observer: '_hashSeparatorChanged',\n      },\n    };\n  }\n\n  get listeners () {\n    return {\n      'route-not-found': 'handleRouteNotFound(evt)',\n    };\n  }\n\n  handleRouteNotFound (evt) {\n    console.error('Route not found: ' + evt.detail);\n  }\n\n  _titleChanged (title) {\n    document.title = title;\n  }\n\n  created () {\n    xin.put('app', this);\n\n    // this.classList.add('xin-app');\n\n    this.__appSignature = true;\n    this.location = window.location;\n    this.history = window.history;\n\n    // default values\n    this.handlers = [];\n    this.middlewares = [];\n\n    this.__started = false;\n  }\n\n  _hashSeparatorChanged (hashSeparator) {\n    this.reHashSeparator = new RegExp(hashSeparator + '(.*)$');\n  }\n\n  attached () {\n    if (!this.manual) {\n      this.async(this.start);\n    }\n  }\n\n  __isStatic (pattern) {\n    return !pattern.match(/[[{]/);\n  }\n\n  __routeRegExp (str) {\n    let chunks = str.split('[');\n\n    if (chunks.length > 2) {\n      throw new Error('Invalid use of optional params');\n    }\n\n    let tokens = [];\n    let re = chunks[0].replace(/{([^}]+)}/g, function (g, token) {\n      tokens.push(token);\n      return '([^/]+)';\n    }).replace(/\\//g, '\\\\/');\n\n    let optRe = '';\n\n    if (chunks[1]) {\n      optRe = '(?:' + chunks[1].slice(0, -1).replace(/{([^}]+)}/g, function (g, token) {\n        tokens.push(token);\n        return '([^/]+)';\n      }).replace(/\\//g, '\\\\/') + ')?';\n    }\n    return [ new RegExp('^' + re + optRe + '$'), tokens ];\n  }\n\n  route (route, callback) {\n    let routeHandler = {\n      route: route,\n      type: 's',\n      pattern: null,\n      args: [],\n      callback: callback,\n    };\n\n    if (!this.__isStatic(route)) {\n      let result = this.__routeRegExp(route);\n\n      routeHandler.type = 'v';\n      routeHandler.pattern = result[0];\n      routeHandler.args = result[1];\n    }\n\n    this.handlers.push(routeHandler);\n  }\n\n  async start () {\n    if (this.__started) {\n      return;\n    }\n\n    this.__middlewareChainRun = compose(this.middlewares);\n\n    // this.__starting = true;\n    let executed = await this.__execute();\n    // this.__starting = false;\n\n    if (executed) {\n      console.info(`Started    ${this.__getId()}`);\n\n      this.__started = true;\n\n      this.__listenNavigation();\n\n      this.fire('started');\n    }\n  }\n\n  __listenNavigation () {\n    let callback = this.__executeCallback = () => {\n      this.__execute();\n    };\n\n    if (this.mode === 'history') {\n      window.addEventListener('popstate', callback, false);\n      document.addEventListener('click', function (evt) {\n        if (!evt.defaultPrevented && evt.target.nodeName === 'A' && evt.target.target === '') {\n          evt.preventDefault();\n\n          let state = { url: evt.target.getAttribute('href') };\n          this.history.pushState(state, evt.target.innerHTML, evt.target.href);\n\n          callback();\n        }\n      }.bind(this));\n    } else {\n      window.addEventListener('hashchange', callback, false);\n    }\n  }\n\n  get started () {\n    return this.__started || false;\n  }\n\n  getFragmentExecutors (fragment) {\n    fragment = fragment || this.getFragment();\n\n    return this.handlers.reduce((executors, handler) => {\n      if (handler.type === 's') {\n        if (fragment === handler.route) {\n          executors.push({ handler: handler, args: {} });\n        }\n      } else if (handler.type === 'v') {\n        let result = fragment.match(handler.pattern);\n        if (result) {\n          let args = {};\n\n          handler.args.forEach(function (name, index) {\n            args[name] = result[index + 1];\n          });\n\n          executors.push({\n            handler: handler,\n            args: args,\n          });\n        }\n      }\n      return executors;\n    }, []);\n  }\n\n  async __execute () {\n    let fragment = this.getFragment();\n\n    let executors = this.getFragmentExecutors(fragment);\n    if (executors.length === 0) {\n      this.fire('route-not-found', fragment);\n      return false;\n    }\n\n    let context = { uri: fragment };\n\n    this.fire('navigated', context);\n\n    // run middleware chain then execute all executors\n    await this.__middlewareChainRun(context, () => {\n      executors.forEach(executor => executor.handler.callback(executor.args, context));\n    });\n\n    return true;\n  }\n\n  navigate (path, options) {\n    path = path || '/';\n    options = options || {};\n\n    if (this.mode === 'history') {\n      let url = this.rootUri + path.toString().replace(/\\/$/, '').replace(/^\\//, '');\n      if (this.location.href.replace(this.location.origin, '') !== url) {\n        this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n        this.__execute();\n      }\n    } else {\n      this.location.href.match(this.reHashSeparator);\n      this.location.href = this.location.href.replace(this.reHashSeparator, '') + this.hashSeparator + path;\n    }\n    return this;\n  }\n\n  use (middleware) {\n    this.middlewares.push(middleware);\n  }\n\n  getFragment () {\n    let fragment;\n    if (this.mode === 'history') {\n      fragment = decodeURI(this.location.pathname + this.location.search);\n      fragment = fragment.replace(/\\?(.*)$/, '');\n      fragment = this.rootUri === '/' ? fragment : fragment.replace(this.rootUri, '');\n    } else {\n      let match = this.location.href.match(this.reHashSeparator);\n      fragment = match ? match[1] : '';\n    }\n\n    return '/' + fragment.toString().replace(/\\/$/, '').replace(/^\\//, '');\n  }\n\n  // $back (evt) {\n  //   evt.preventDefault();\n  //   this.history.back();\n  // }\n}\n\nxin.define('xin-app', App);\n\nfunction compose (middlewares) {\n  for (const fn of middlewares) {\n    if (typeof fn !== 'function') {\n      throw new TypeError('Middleware must be composed of functions!');\n    }\n  }\n\n  return async (context, next) => {\n    // last called middlewares #\n    let index = -1;\n\n    async function dispatch (i) {\n      if (i <= index) {\n        throw new Error('next() called multiple times');\n      }\n\n      index = i;\n      let fn = middlewares[i];\n      if (i === middlewares.length) {\n        fn = next;\n      }\n      if (!fn) {\n        return;\n      }\n\n      return await fn(context, () => dispatch(i + 1));\n    }\n\n    return dispatch(0);\n  };\n}\n\nxin.App = App;\n\nmodule.exports = App;\n\n\n\n/** WEBPACK FOOTER **\n ** ./components/app.js\n **/"],"sourceRoot":""}
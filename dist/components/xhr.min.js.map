{"version":3,"sources":["webpack:///components/xhr.min.js","webpack:///./components/xhr.js"],"names":["webpackJsonp","module","exports","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","xin","XHR","_xin$Component","this","getPrototypeOf","apply","arguments","debounce","__request","debounceDuration","url","generateUrl","request","method","as","then","xhr","fire","body","bind","err","error","options","toUpperCase","__prepareOptions","Promise","resolve","reject","XMLHttpRequest","open","async","onload","handleAs","contentType","getResponseHeader","indexOf","status","JSON","parse","responseText","responseXML","response","Error","onerror","send","get","type","String","observer","Number","Component","define"],"mappings":"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","file":"components/xhr.min.js","sourcesContent":["webpackJsonp([4],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/* globals XMLHttpRequest */\n\t\n\tvar xin = __webpack_require__(1);\n\t\n\tvar XHR = function (_xin$Component) {\n\t  _inherits(XHR, _xin$Component);\n\t\n\t  function XHR() {\n\t    _classCallCheck(this, XHR);\n\t\n\t    return _possibleConstructorReturn(this, (XHR.__proto__ || Object.getPrototypeOf(XHR)).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(XHR, [{\n\t    key: '__urlChanged',\n\t    value: function __urlChanged() {\n\t      this.debounce('__request', this.__request, this.debounceDuration);\n\t    }\n\t  }, {\n\t    key: '__asChanged',\n\t    value: function __asChanged() {\n\t      this.debounce('__request', this.__request, this.debounceDuration);\n\t    }\n\t  }, {\n\t    key: '__request',\n\t    value: function __request() {\n\t      var url = this.generateUrl();\n\t      if (!url) {\n\t        return;\n\t      }\n\t\n\t      return this.request({\n\t        method: this.method,\n\t        url: url,\n\t        as: this.as\n\t      }).then(function (xhr) {\n\t        this.fire('response', {\n\t          body: xhr.body,\n\t          xhr: xhr\n\t        });\n\t      }.bind(this), function (err) {\n\t        this.fire('error', {\n\t          error: err,\n\t          xhr: err.xhr\n\t        });\n\t      }.bind(this));\n\t    }\n\t  }, {\n\t    key: 'generateUrl',\n\t    value: function generateUrl() {\n\t      return this.url;\n\t    }\n\t  }, {\n\t    key: '__prepareOptions',\n\t    value: function __prepareOptions(options) {\n\t      options = options || {};\n\t      options.method = (options.method || 'get').toUpperCase();\n\t      return options;\n\t    }\n\t  }, {\n\t    key: 'request',\n\t    value: function request(options) {\n\t      options = this.__prepareOptions(options);\n\t      return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        try {\n\t          xhr.open(options.method, options.url, options.async || true);\n\t          xhr.onload = function () {\n\t            var handleAs = options.as;\n\t            if (handleAs === 'intelligent') {\n\t              var contentType = xhr.getResponseHeader('Content-Type');\n\t              if (contentType.indexOf('json') >= 0) {\n\t                handleAs = 'json';\n\t              } else if (contentType.indexOf('html') >= 0) {\n\t                handleAs = 'html';\n\t              } else if (contentType.indexOf('xml') >= 0) {\n\t                handleAs = 'xml';\n\t              } else {\n\t                handleAs = 'text';\n\t              }\n\t            }\n\t            if (xhr.status >= 200 && xhr.status < 400) {\n\t              switch (handleAs) {\n\t                case 'json':\n\t                  try {\n\t                    xhr.body = JSON.parse(xhr.responseText);\n\t                    resolve(xhr);\n\t                  } catch (err) {\n\t                    err.xhr = xhr;\n\t                    reject(err);\n\t                  }\n\t                  break;\n\t                case 'xml':\n\t                  xhr.body = xhr.responseXML;\n\t                  resolve(xhr);\n\t                  break;\n\t                default:\n\t                  xhr.body = xhr.response;\n\t                  resolve(xhr);\n\t              }\n\t            } else {\n\t              var err = new Error('Http status ' + xhr.status);\n\t              err.xhr = xhr;\n\t              reject(err);\n\t            }\n\t          };\n\t          xhr.onerror = function (err) {\n\t            err.xhr = xhr;\n\t            reject(err);\n\t          };\n\t          xhr.send(options.body);\n\t        } catch (err) {\n\t          err.xhr = xhr;\n\t          reject(err);\n\t        }\n\t      });\n\t    }\n\t  }, {\n\t    key: 'props',\n\t    get: function get() {\n\t      return {\n\t        method: {\n\t          type: String,\n\t          value: 'get'\n\t        },\n\t\n\t        url: {\n\t          type: String,\n\t          observer: '__urlChanged'\n\t        },\n\t\n\t        as: {\n\t          type: String,\n\t          value: 'intelligent',\n\t          observer: '__asChanged'\n\t        },\n\t\n\t        debounceDuration: {\n\t          type: Number,\n\t          value: 0\n\t        }\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return XHR;\n\t}(xin.Component);\n\t\n\txin.define('xin-xhr', XHR);\n\txin.XHR = XHR;\n\t\n\tmodule.exports = XHR;\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** components/xhr.min.js\n **/","/* globals XMLHttpRequest */\n\nconst xin = require('../');\n\nclass XHR extends xin.Component {\n  get props () {\n    return {\n      method: {\n        type: String,\n        value: 'get',\n      },\n\n      url: {\n        type: String,\n        observer: '__urlChanged',\n      },\n\n      as: {\n        type: String,\n        value: 'intelligent',\n        observer: '__asChanged',\n      },\n\n      debounceDuration: {\n        type: Number,\n        value: 0,\n      },\n    };\n  }\n\n  __urlChanged () {\n    this.debounce('__request', this.__request, this.debounceDuration);\n  }\n\n  __asChanged () {\n    this.debounce('__request', this.__request, this.debounceDuration);\n  }\n\n  __request () {\n    var url = this.generateUrl();\n    if (!url) {\n      return;\n    }\n\n    return this.request({\n      method: this.method,\n      url: url,\n      as: this.as,\n    }).then(function (xhr) {\n      this.fire('response', {\n        body: xhr.body,\n        xhr: xhr,\n      });\n    }.bind(this), function (err) {\n      this.fire('error', {\n        error: err,\n        xhr: err.xhr,\n      });\n    }.bind(this));\n  }\n\n  generateUrl () {\n    return this.url;\n  }\n\n  __prepareOptions (options) {\n    options = options || {};\n    options.method = (options.method || 'get').toUpperCase();\n    return options;\n  }\n\n  request (options) {\n    options = this.__prepareOptions(options);\n    return new Promise(function (resolve, reject) {\n      var xhr = new XMLHttpRequest();\n      try {\n        xhr.open(options.method, options.url, options.async || true);\n        xhr.onload = function () {\n          var handleAs = options.as;\n          if (handleAs === 'intelligent') {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (contentType.indexOf('json') >= 0) {\n              handleAs = 'json';\n            } else if (contentType.indexOf('html') >= 0) {\n              handleAs = 'html';\n            } else if (contentType.indexOf('xml') >= 0) {\n              handleAs = 'xml';\n            } else {\n              handleAs = 'text';\n            }\n          }\n          if (xhr.status >= 200 && xhr.status < 400) {\n            switch (handleAs) {\n              case 'json':\n                try {\n                  xhr.body = JSON.parse(xhr.responseText);\n                  resolve(xhr);\n                } catch (err) {\n                  err.xhr = xhr;\n                  reject(err);\n                }\n                break;\n              case 'xml':\n                xhr.body = xhr.responseXML;\n                resolve(xhr);\n                break;\n              default:\n                xhr.body = xhr.response;\n                resolve(xhr);\n            }\n          } else {\n            var err = new Error('Http status ' + xhr.status);\n            err.xhr = xhr;\n            reject(err);\n          }\n        };\n        xhr.onerror = function (err) {\n          err.xhr = xhr;\n          reject(err);\n        };\n        xhr.send(options.body);\n      } catch (err) {\n        err.xhr = xhr;\n        reject(err);\n      }\n    });\n  }\n}\n\nxin.define('xin-xhr', XHR);\nxin.XHR = XHR;\n\nmodule.exports = XHR;\n\n\n\n/** WEBPACK FOOTER **\n ** ./components/xhr.js\n **/"],"sourceRoot":""}
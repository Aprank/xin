{"version":3,"sources":["webpack:///components/xhr.min.js","webpack:///./components/xhr.js"],"names":["webpackJsonp","module","exports","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","xin","XHR","_xin$Component","this","getPrototypeOf","apply","arguments","auto","generateRequest","_this2","url","generateUrl","req","method","as","then","xhr","body","fire","err","error","debounce","_requestFlight","debounceDuration","options","toUpperCase","_this3","__prepareOptions","Promise","resolve","reject","XMLHttpRequest","doResolve","set","responseBody","doReject","open","async","onload","handleAs","contentType","getResponseHeader","indexOf","status","JSON","parse","responseText","responseXML","response","Error","onerror","send","get","type","Boolean","String","observer","Number","request","notify","Component","define"],"mappings":"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","file":"components/xhr.min.js","sourcesContent":["webpackJsonp([4],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/* globals XMLHttpRequest */\n\t\n\tvar xin = __webpack_require__(1);\n\t\n\tvar XHR = function (_xin$Component) {\n\t  _inherits(XHR, _xin$Component);\n\t\n\t  function XHR() {\n\t    _classCallCheck(this, XHR);\n\t\n\t    return _possibleConstructorReturn(this, (XHR.__proto__ || Object.getPrototypeOf(XHR)).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(XHR, [{\n\t    key: '_urlChanged',\n\t    value: function _urlChanged() {\n\t      if (this.auto) {\n\t        this.generateRequest();\n\t      }\n\t    }\n\t  }, {\n\t    key: '_asChanged',\n\t    value: function _asChanged() {\n\t      if (this.auto) {\n\t        this.generateRequest();\n\t      }\n\t    }\n\t  }, {\n\t    key: '_requestFlight',\n\t    value: function _requestFlight() {\n\t      var _this2 = this;\n\t\n\t      var url = this.generateUrl();\n\t      if (!url) {\n\t        return;\n\t      }\n\t\n\t      return this.req({\n\t        method: this.method,\n\t        url: url,\n\t        as: this.as\n\t      }).then(function (xhr) {\n\t        var body = xhr.body;\n\t        _this2.fire('response', {\n\t          body: body,\n\t          xhr: xhr\n\t        });\n\t        return body;\n\t      }, function (err) {\n\t        _this2.fire('error', {\n\t          error: err,\n\t          xhr: err.xhr\n\t        });\n\t        throw err;\n\t      });\n\t    }\n\t  }, {\n\t    key: 'generateRequest',\n\t    value: function generateRequest() {\n\t      this.debounce('_requestFlight', this._requestFlight, this.debounceDuration);\n\t    }\n\t  }, {\n\t    key: 'generateUrl',\n\t    value: function generateUrl() {\n\t      return this.url;\n\t    }\n\t  }, {\n\t    key: '__prepareOptions',\n\t    value: function __prepareOptions(options) {\n\t      options = options || {};\n\t      options.method = (options.method || 'get').toUpperCase();\n\t      return options;\n\t    }\n\t  }, {\n\t    key: 'req',\n\t    value: function req(options) {\n\t      var _this3 = this;\n\t\n\t      options = this.__prepareOptions(options);\n\t\n\t      return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        var doResolve = function doResolve() {\n\t          _this3.set('response', xhr.responseBody);\n\t          resolve(xhr);\n\t        };\n\t        var doReject = function doReject(err) {\n\t          _this3.set('error', err);\n\t          reject(err);\n\t        };\n\t\n\t        try {\n\t          xhr.open(options.method, options.url, options.async || true);\n\t          xhr.onload = function () {\n\t            var handleAs = options.as;\n\t            if (handleAs === 'intelligent') {\n\t              var contentType = xhr.getResponseHeader('Content-Type');\n\t              if (contentType.indexOf('json') >= 0) {\n\t                handleAs = 'json';\n\t              } else if (contentType.indexOf('html') >= 0) {\n\t                handleAs = 'html';\n\t              } else if (contentType.indexOf('xml') >= 0) {\n\t                handleAs = 'xml';\n\t              } else {\n\t                handleAs = 'text';\n\t              }\n\t            }\n\t            if (xhr.status >= 200 && xhr.status < 400) {\n\t              switch (handleAs) {\n\t                case 'json':\n\t                  try {\n\t                    xhr.responseBody = JSON.parse(xhr.responseText);\n\t                  } catch (err) {\n\t                    return doReject(err);\n\t                  }\n\t                  break;\n\t                case 'xml':\n\t                  xhr.responseBody = xhr.responseXML;\n\t                  break;\n\t                default:\n\t                  xhr.responseBody = xhr.response;\n\t                  break;\n\t              }\n\t              doResolve();\n\t            } else {\n\t              doReject(new Error('Http status ' + xhr.status));\n\t            }\n\t          };\n\t          xhr.onerror = doReject;\n\t          xhr.send(options.body);\n\t        } catch (err) {\n\t          doReject(err);\n\t        }\n\t      });\n\t    }\n\t  }, {\n\t    key: 'props',\n\t    get: function get() {\n\t      return {\n\t        auto: {\n\t          type: Boolean,\n\t          value: false\n\t        },\n\t\n\t        method: {\n\t          type: String,\n\t          value: 'get'\n\t        },\n\t\n\t        url: {\n\t          type: String,\n\t          observer: '_urlChanged'\n\t        },\n\t\n\t        as: {\n\t          type: String,\n\t          value: 'intelligent',\n\t          observer: '_asChanged'\n\t        },\n\t\n\t        debounceDuration: {\n\t          type: Number,\n\t          value: 0\n\t        },\n\t\n\t        request: {\n\t          type: Object,\n\t          notify: true\n\t        },\n\t\n\t        response: {\n\t          type: Object,\n\t          notify: true\n\t        },\n\t\n\t        error: {\n\t          type: Object,\n\t          notify: true\n\t        }\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return XHR;\n\t}(xin.Component);\n\t\n\txin.define('xin-xhr', XHR);\n\txin.XHR = XHR;\n\t\n\tmodule.exports = XHR;\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** components/xhr.min.js\n **/","/* globals XMLHttpRequest */\n\nconst xin = require('../src/');\n\nclass XHR extends xin.Component {\n  get props () {\n    return {\n      auto: {\n        type: Boolean,\n        value: false,\n      },\n\n      method: {\n        type: String,\n        value: 'get',\n      },\n\n      url: {\n        type: String,\n        observer: '_urlChanged',\n      },\n\n      as: {\n        type: String,\n        value: 'intelligent',\n        observer: '_asChanged',\n      },\n\n      debounceDuration: {\n        type: Number,\n        value: 0,\n      },\n\n      request: {\n        type: Object,\n        notify: true,\n      },\n\n      response: {\n        type: Object,\n        notify: true,\n      },\n\n      error: {\n        type: Object,\n        notify: true,\n      },\n    };\n  }\n\n  _urlChanged () {\n    if (this.auto) {\n      this.generateRequest();\n    }\n  }\n\n  _asChanged () {\n    if (this.auto) {\n      this.generateRequest();\n    }\n  }\n\n  _requestFlight () {\n    let url = this.generateUrl();\n    if (!url) {\n      return;\n    }\n\n    return this.req({\n      method: this.method,\n      url: url,\n      as: this.as,\n    }).then(xhr => {\n      let body = xhr.body;\n      this.fire('response', {\n        body: body,\n        xhr: xhr,\n      });\n      return body;\n    }, err => {\n      this.fire('error', {\n        error: err,\n        xhr: err.xhr,\n      });\n      throw err;\n    });\n  }\n\n  generateRequest () {\n    this.debounce('_requestFlight', this._requestFlight, this.debounceDuration);\n  }\n\n  generateUrl () {\n    return this.url;\n  }\n\n  __prepareOptions (options) {\n    options = options || {};\n    options.method = (options.method || 'get').toUpperCase();\n    return options;\n  }\n\n  req (options) {\n    options = this.__prepareOptions(options);\n\n    return new Promise((resolve, reject) => {\n      let xhr = new XMLHttpRequest();\n      let doResolve = () => {\n        this.set('response', xhr.responseBody);\n        resolve(xhr);\n      };\n      let doReject = err => {\n        this.set('error', err);\n        reject(err);\n      };\n\n      try {\n        xhr.open(options.method, options.url, options.async || true);\n        xhr.onload = () => {\n          var handleAs = options.as;\n          if (handleAs === 'intelligent') {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (contentType.indexOf('json') >= 0) {\n              handleAs = 'json';\n            } else if (contentType.indexOf('html') >= 0) {\n              handleAs = 'html';\n            } else if (contentType.indexOf('xml') >= 0) {\n              handleAs = 'xml';\n            } else {\n              handleAs = 'text';\n            }\n          }\n          if (xhr.status >= 200 && xhr.status < 400) {\n            switch (handleAs) {\n              case 'json':\n                try {\n                  xhr.responseBody = JSON.parse(xhr.responseText);\n                } catch (err) {\n                  return doReject(err);\n                }\n                break;\n              case 'xml':\n                xhr.responseBody = xhr.responseXML;\n                break;\n              default:\n                xhr.responseBody = xhr.response;\n                break;\n            }\n            doResolve();\n          } else {\n            doReject(new Error('Http status ' + xhr.status));\n          }\n        };\n        xhr.onerror = doReject;\n        xhr.send(options.body);\n      } catch (err) {\n        doReject(err);\n      }\n    });\n  }\n}\n\nxin.define('xin-xhr', XHR);\nxin.XHR = XHR;\n\nmodule.exports = XHR;\n\n\n\n/** WEBPACK FOOTER **\n ** ./components/xhr.js\n **/"],"sourceRoot":""}